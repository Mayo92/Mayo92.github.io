<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <meta name="keywords" content="Hexo Theme Keep">
    <meta name="description" content="我小的时候很怕哲学家，因为大人们告诉我哲学家没有感情都是冷血动物。但事实并非如此，当FA♂乐器响起之时，他们如获新生">
    <meta name="author" content="Mayo">
    
    <title>
        
            Android面试-基础 |
        
        妙妙屋
    </title>
    
<link rel="stylesheet" href="/css/style.css">

    
    
<link rel="stylesheet" href="/font/css/fontawesome.min.css">

    
<link rel="stylesheet" href="/font/css/regular.min.css">

    
<link rel="stylesheet" href="/font/css/solid.min.css">

    
<link rel="stylesheet" href="/font/css/brands.min.css">

    
    <script class="keep-theme-configurations">
    const KEEP = window.KEEP || {}
    KEEP.hexo_config = {"hostname":"yoursite.com","root":"/","language":"zh-CN"}
    KEEP.theme_config = {"base_info":{"primary_color":"#0066cc","title":"妙妙屋","author":"Mayo","avatar":"https://avatars.githubusercontent.com/u/16527293?v=4","logo":null,"favicon":null},"menu":{"home":"/","archives":"/archives","categories":"/categories","about":"/about-me"},"first_screen":{"enable":false,"background_img":"/images/bg.svg","background_img_dark":"/images/bg.svg","description":"Keep writing and Keep loving.","hitokoto":false},"social_contact":{"enable":false,"links":{"github":null,"weixin":null,"qq":null,"weibo":null,"zhihu":null,"twitter":null,"x":null,"facebook":null,"email":null}},"scroll":{"progress_bar":false,"percent":false,"hide_header":true},"home":{"announcement":null,"category":false,"tag":false,"post_datetime":"updated"},"post":{"author_badge":{"enable":false,"level_badge":true,"custom_badge":["One","Two","Three"]},"word_count":{"wordcount":false,"min2read":false},"datetime_format":"YYYY-MM-DD HH:mm:ss","copyright_info":false,"share":false,"reward":{"enable":false,"img_link":null,"text":null}},"code_block":{"tools":{"enable":true,"style":"default"},"highlight_theme":"default"},"toc":{"enable":true,"number":true,"expand_all":false,"init_open":true,"layout":"right"},"website_count":{"busuanzi_count":{"enable":false,"site_uv":false,"site_pv":false,"page_pv":false}},"local_search":{"enable":false,"preload":false},"comment":{"enable":false,"use":"valine","valine":{"appid":null,"appkey":null,"server_urls":null,"placeholder":null},"gitalk":{"github_id":null,"github_admins":null,"repository":null,"client_id":null,"client_secret":null,"proxy":null},"twikoo":{"env_id":null,"region":null,"version":"1.6.36"},"waline":{"server_url":null,"reaction":false,"version":"3.2.1"},"giscus":{"repo":null,"repo_id":null,"category":"Announcements","category_id":null,"reactions_enabled":false},"artalk":{"server":null},"disqus":{"shortname":null}},"rss":{"enable":false},"lazyload":{"enable":false},"cdn":{"enable":false,"provider":"cdnjs"},"pjax":{"enable":false},"footer":{"since":2017,"word_count":false,"site_deploy":{"enable":false,"provider":"github","url":null},"record":{"enable":false,"list":[{"code":null,"link":null}]}},"inject":{"enable":false,"css":[null],"js":[null]},"root":"","source_data":{},"version":"4.1.5"}
    KEEP.language_ago = {"second":"%s 秒前","minute":"%s 分钟前","hour":"%s 小时前","day":"%s 天前","week":"%s 周前","month":"%s 个月前","year":"%s 年前"}
    KEEP.language_code_block = {"copy":"复制代码","copied":"已复制","fold":"折叠代码块","folded":"已折叠"}
    KEEP.language_copy_copyright = {"copy":"复制版权信息","copied":"已复制","title":"原文标题","author":"原文作者","link":"原文链接"}
  </script>
<meta name="generator" content="Hexo 7.2.0"></head>


<body>
<div class="progress-bar-container">
    

    
</div>



<main class="page-container border-box">
    <!-- home first screen  -->
    

    <!-- page content -->
    <div class="page-main-content border-box">
        <div class="page-main-content-top">
            
<header class="header-wrapper">

    <div class="border-box header-content">
        <div class="left border-box">
            
            <a class="site-name border-box" href="/">
               妙妙屋
            </a>
        </div>

        <div class="right border-box">
            <div class="pc">
                <ul class="menu-list">
                    
                        
                        <li class="menu-item">
                            <a class=""
                               href="/"
                            >
                                
                                首页
                            </a>
                        </li>
                    
                        
                        <li class="menu-item">
                            <a class=""
                               href="/archives"
                            >
                                
                                归档
                            </a>
                        </li>
                    
                        
                        <li class="menu-item">
                            <a class=""
                               href="/categories"
                            >
                                
                                分类
                            </a>
                        </li>
                    
                        
                        <li class="menu-item">
                            <a class=""
                               href="/about-me"
                            >
                                
                                关于
                            </a>
                        </li>
                    
                    
                </ul>
            </div>
            <div class="mobile">
                
                <div class="icon-item menu-bar">
                    <div class="menu-bar-middle"></div>
                </div>
            </div>
        </div>
    </div>

    <div class="header-drawer">
        <ul class="drawer-menu-list">
            
                
                <li class="drawer-menu-item flex-center">
                    <a class=""
                       href="/"
                    >首页</a>
                </li>
            
                
                <li class="drawer-menu-item flex-center">
                    <a class=""
                       href="/archives"
                    >归档</a>
                </li>
            
                
                <li class="drawer-menu-item flex-center">
                    <a class=""
                       href="/categories"
                    >分类</a>
                </li>
            
                
                <li class="drawer-menu-item flex-center">
                    <a class=""
                       href="/about-me"
                    >关于</a>
                </li>
            
        </ul>
    </div>

    <div class="window-mask"></div>

</header>


        </div>

        <div class="page-main-content-middle border-box">

            <div class="main-content border-box">
                

                    
<div class="fade-in-down-animation">
    <div class="post-page-container border-box">
        <div class="post-content-container border-box">
            

            <div class="post-content-bottom border-box">
                
                    <div class="post-title">
                        Android面试-基础
                    </div>
                

                
                    <div class="post-header border-box">
                        
                            <div class="avatar-box border-box">
                                <img src="https://avatars.githubusercontent.com/u/16527293?v=4">
                            </div>
                        
                        <div class="info-box">
                            <div class="author border-box">
                                <span class="name">Mayo</span>
                                
                            </div>
                            <div class="meta-info border-box">
                                

<div class="post-meta-info-container border-box post">
    <div class="post-meta-info border-box">
        

        
            <span class="meta-info-item post-create-date">
                <i class="icon fa-solid fa-calendar-plus"></i>&nbsp;
                <span class="datetime">2020-06-03 16:28:56</span>
            </span>

            <span class="meta-info-item post-update-date">
                <i class="icon fa-solid fa-file-pen"></i>&nbsp;
                <span class="datetime" data-updated="Sun Jul 14 2024 09:40:38 GMT+0800">2024-07-14 09:40:38</span>
            </span>
        

        
            <span class="meta-info-item post-category border-box"><i class="icon fas fa-folder"></i>&nbsp;
                <ul class="post-category-ul">
                    
                            <li class="category-item"><a href="/categories/%E9%9D%A2%E8%AF%95/">面试</a></li>
                        
                    
                </ul>
            </span>
        

        
            <span class="post-tag meta-info-item border-box">
                <ul class="post-tag-ul">
                    
                            <li class="tag-item"><span class="tag-separator"><i class="icon fas fa-hashtag"></i></span><a href="/tags/Android%E9%9D%A2%E8%AF%95/">Android面试</a></li>
                        
                    
                </ul>
            </span>
        

        
        
        
        
    </div>

    
</div>

                            </div>
                        </div>
                    </div>
                

                <div class="post-content keep-markdown-body ">
                    

                    
                         <h3 id="Activity"><a href="#Activity" class="headerlink" title="Activity"></a>Activity</h3><p>Activity是与用户交互的接口</p>
<span id="more"></span>

<h3 id="Activity任务栈"><a href="#Activity任务栈" class="headerlink" title="Activity任务栈"></a>Activity任务栈</h3><p><img src="/2020/06/03/Android%E9%9D%A2%E8%AF%95-%E5%9F%BA%E7%A1%80/1.png"></p>
<p>Android通过Activity栈管理Activity，Activity状态决定了它在栈中的位置</p>
<h3 id="Activity四种形态"><a href="#Activity四种形态" class="headerlink" title="Activity四种形态"></a>Activity四种形态</h3><ol>
<li>Active：Activity处于栈顶（栈顶，可见，与用户进行交互）</li>
<li>Paused：可见但不可交互（数据、状态、成员变量都是存在的，内存不足时可能会被回收）</li>
<li>Stopped：不可见</li>
<li>Killed：系统回收掉</li>
</ol>
<h3 id="正常情况生命周期回调"><a href="#正常情况生命周期回调" class="headerlink" title="正常情况生命周期回调"></a>正常情况生命周期回调</h3><p><img src="/2020/06/03/Android%E9%9D%A2%E8%AF%95-%E5%9F%BA%E7%A1%80/2.png"></p>
<h3 id="异常情况生命周期回调"><a href="#异常情况生命周期回调" class="headerlink" title="异常情况生命周期回调"></a>异常情况生命周期回调</h3><ul>
<li>onSaveInstanceState()</li>
<li>onRestoreInstanceState()与onCreate()都可以进行数据恢复，但前者的Bundle数据一定不为空，所以不用进行非空判断</li>
</ul>
<h3 id="生命周期总结"><a href="#生命周期总结" class="headerlink" title="生命周期总结"></a>生命周期总结</h3><ol>
<li>正常启动：onCreate()-onStart()-onResume()</li>
<li>back回退：onPause()-onStop()-onDestroy()</li>
<li>打开新Activity：onPause()-onStop()</li>
<li>Activity异常：onSaveInstanceState()保存数据</li>
<li>Activity重新创建：onRestoreInstanceState()</li>
</ol>
<h3 id="Activity之间通信"><a href="#Activity之间通信" class="headerlink" title="Activity之间通信"></a>Activity之间通信</h3><ol>
<li>Intent&#x2F;Bundle</li>
<li>类静态变量</li>
<li>全局变量</li>
</ol>
<h3 id="Activity与Fragment通信"><a href="#Activity与Fragment通信" class="headerlink" title="Activity与Fragment通信"></a>Activity与Fragment通信</h3><h4 id="Activity将数据传递给Fragment"><a href="#Activity将数据传递给Fragment" class="headerlink" title="Activity将数据传递给Fragment"></a>Activity将数据传递给Fragment</h4><ol>
<li>Bundle</li>
<li>直接在Activity中定义方法</li>
</ol>
<p><img src="/2020/06/03/Android%E9%9D%A2%E8%AF%95-%E5%9F%BA%E7%A1%80/3.png"></p>
<p><img src="/2020/06/03/Android%E9%9D%A2%E8%AF%95-%E5%9F%BA%E7%A1%80/4.png"></p>
<p><img src="/2020/06/03/Android%E9%9D%A2%E8%AF%95-%E5%9F%BA%E7%A1%80/5.png"></p>
<h4 id="Fragment将数据传递给Activity"><a href="#Fragment将数据传递给Activity" class="headerlink" title="Fragment将数据传递给Activity"></a>Fragment将数据传递给Activity</h4><ol>
<li>fragment中定义一个内部回调接口</li>
<li>fragment的方法onAttach()</li>
<li>调用onDeach方法，把传递进来的Activity对象释放掉</li>
</ol>
<p>Fragment</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line">public class TestFragment extends Fragment implements View.OnClickListener &#123;</span><br><span class="line"></span><br><span class="line">   	// 2.1 定义用来与外部activity交互，获取到宿主activity</span><br><span class="line">   	private FragmentListener listener;</span><br><span class="line"></span><br><span class="line">   	// 1 定义了所有activity必须实现的接口方法</span><br><span class="line">   	public interface FragmentListener&#123;</span><br><span class="line">       	void process(String str);</span><br><span class="line">   	&#125;</span><br><span class="line"></span><br><span class="line">   	@Override</span><br><span class="line">   	public void onAttach(Activity activity) &#123;</span><br><span class="line">       	super.onAttach(activity);</span><br><span class="line"></span><br><span class="line">       	if(activity instanceof FragmentListener) &#123;</span><br><span class="line">           	listener = (FragmentListener)activity; // 2.2 获取到宿主activity并赋值</span><br><span class="line">       	&#125; else&#123;</span><br><span class="line">           	throw new IllegalArgumentException(&quot;activity must implements FragmentListener&quot;);</span><br><span class="line">       	&#125;</span><br><span class="line">   	&#125;</span><br><span class="line"></span><br><span class="line">   	@Override</span><br><span class="line">   	public void onClick(View v) &#123;</span><br><span class="line">       	listener.process(&quot;我是接口&quot;); //3.1 执行回调</span><br><span class="line">   	&#125;</span><br><span class="line"></span><br><span class="line">   	//把传递进来的activity对象释放掉，防止内存泄漏</span><br><span class="line">   	@Override</span><br><span class="line">   	public void onDetach() &#123;</span><br><span class="line">       	super.onDetach();</span><br><span class="line">       	listener = null;</span><br><span class="line">   	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>Activity</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">class MainActivity : AppCompatActivity(),TestFragment.FragmentListener &#123;</span><br><span class="line">   </span><br><span class="line">   	override fun process(str: String?) &#123;</span><br><span class="line">       	TODO(&quot;not implemented&quot;) //To change body of created functions use File | Settings | File Templates.</span><br><span class="line">   	&#125;</span><br><span class="line"></span><br><span class="line">   	override fun onCreate(savedInstanceState: Bundle?) &#123;</span><br><span class="line">       	super.onCreate(savedInstanceState)</span><br><span class="line">       	setContentView(R.layout.activity_main)</span><br><span class="line">   	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="Activity与Service通信"><a href="#Activity与Service通信" class="headerlink" title="Activity与Service通信"></a>Activity与Service通信</h3><ol>
<li>绑定服务，利用ServiceConnection类</li>
<li>简单通信，利用Intent进行传值</li>
<li>定义一个callback接口来监听服务中的进程变化</li>
</ol>
<p>Service</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line">public class MyService extends Service &#123;</span><br><span class="line"></span><br><span class="line">   	public String data = &quot;服务器正在执行&quot;;</span><br><span class="line"></span><br><span class="line">   	public MyService() &#123;</span><br><span class="line">   	&#125;</span><br><span class="line">   </span><br><span class="line">   	public class Binder extends android.os.Binder&#123;</span><br><span class="line">       	public void setData(String data)&#123;</span><br><span class="line">           	MyService.this.data = data;</span><br><span class="line">       	&#125;</span><br><span class="line">   	&#125; </span><br><span class="line"></span><br><span class="line">   	@Nullable</span><br><span class="line">   	@Override</span><br><span class="line">   	public IBinder onBind(Intent intent) &#123;</span><br><span class="line">       	return new Binder();</span><br><span class="line">   	&#125;</span><br><span class="line"></span><br><span class="line">   	@Override</span><br><span class="line">   	public int onStartCommand(Intent intent, int flags, int startId) &#123;</span><br><span class="line">       	return super.onStartCommand(intent, flags, startId);</span><br><span class="line">   	&#125;</span><br><span class="line"></span><br><span class="line">   	@Override</span><br><span class="line">   	public void onDestroy() &#123;</span><br><span class="line">       	super.onDestroy();</span><br><span class="line">   	&#125;</span><br><span class="line"></span><br><span class="line">   	@Override</span><br><span class="line">   	public boolean onUnbind(Intent intent) &#123;</span><br><span class="line">       	return super.onUnbind(intent);</span><br><span class="line">   	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>Activity</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">public class ServiceActivity extends AppCompatActivity implements ServiceConnection &#123;</span><br><span class="line">   </span><br><span class="line">   	public MyService.Binder binder = null;//①</span><br><span class="line"></span><br><span class="line">   	@Override</span><br><span class="line">   	protected void onCreate(@Nullable Bundle savedInstanceState) &#123;</span><br><span class="line">       	super.onCreate(savedInstanceState);</span><br><span class="line"></span><br><span class="line">       	if (binder != null)</span><br><span class="line">           	binder.setData(&quot;启动服务了&quot;);//③</span><br><span class="line">   	&#125;</span><br><span class="line"></span><br><span class="line">   	@Override</span><br><span class="line">   	public void onServiceConnected(ComponentName name, IBinder service) &#123;</span><br><span class="line">       	binder = (MyService.Binder)service;//②</span><br><span class="line">   	&#125;</span><br><span class="line"></span><br><span class="line">   	@Override</span><br><span class="line">   	public void onServiceDisconnected(ComponentName name) &#123;</span><br><span class="line"></span><br><span class="line">   	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>Callback方案</p>
<p>Service</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line">public class MyService2 extends Service &#123;</span><br><span class="line"></span><br><span class="line">   	private Callback callback;</span><br><span class="line">   	public String data = &quot;服务器正在执行&quot;;</span><br><span class="line"></span><br><span class="line">   	public void setCallback(Callback callback) &#123;</span><br><span class="line">       	this.callback = callback;</span><br><span class="line">   	&#125;</span><br><span class="line"></span><br><span class="line">   	public Callback getCallback() &#123;</span><br><span class="line">       	return callback;</span><br><span class="line">   	&#125;</span><br><span class="line"></span><br><span class="line">   	public interface Callback &#123;</span><br><span class="line">       	void onDataChange(String data);</span><br><span class="line">   	&#125;</span><br><span class="line"></span><br><span class="line">   	public class Binder extends android.os.Binder &#123;</span><br><span class="line">       	public void setData(String data) &#123;</span><br><span class="line">           	MyService2.this.data = data;</span><br><span class="line">       	&#125;</span><br><span class="line"></span><br><span class="line">       	public MyService2 getMyService() &#123;</span><br><span class="line">           	return MyService2.this;</span><br><span class="line">       	&#125;</span><br><span class="line">   	&#125;</span><br><span class="line">   </span><br><span class="line">   </span><br><span class="line">   	@Nullable</span><br><span class="line">   	@Override</span><br><span class="line">   	public IBinder onBind(Intent intent) &#123;</span><br><span class="line">       	return new Binder();</span><br><span class="line">   	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>Activity</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">public class ServiceActivity2 extends AppCompatActivity implements ServiceConnection &#123;</span><br><span class="line"></span><br><span class="line">   	public MyService2.Binder myBinder = null;</span><br><span class="line"></span><br><span class="line">   	private Handler hander = new Handler()&#123;</span><br><span class="line">       	@Override</span><br><span class="line">       	public void handleMessage(Message msg) &#123;</span><br><span class="line">           	super.handleMessage(msg);</span><br><span class="line">       	&#125;</span><br><span class="line">   	&#125;;</span><br><span class="line">   </span><br><span class="line">   	@Override</span><br><span class="line">   	public void onServiceConnected(ComponentName name, IBinder service) &#123;</span><br><span class="line">       	myBinder = (MyService2.Binder) service;</span><br><span class="line">       	myBinder.getMyService().setCallback(new MyService2.Callback()&#123;</span><br><span class="line">           	@Override</span><br><span class="line">           	public void onDataChange(String data) &#123;</span><br><span class="line">               	Message msg = new Message();</span><br><span class="line">               	Bundle b = new Bundle();</span><br><span class="line">               	b.putString(&quot;data&quot;,data);</span><br><span class="line">               	msg.setData(b);</span><br><span class="line">               	hander.sendMessage(msg);</span><br><span class="line">           	&#125;</span><br><span class="line">       	&#125;);</span><br><span class="line">   	&#125;</span><br><span class="line"></span><br><span class="line">   	@Override</span><br><span class="line">   	public void onServiceDisconnected(ComponentName name) &#123;</span><br><span class="line"></span><br><span class="line">   	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="Activity启动模式"><a href="#Activity启动模式" class="headerlink" title="Activity启动模式"></a>Activity启动模式</h3><ol>
<li>standard</li>
<li>singleTop</li>
<li>singleTask</li>
<li>singleInstance</li>
</ol>
<h4 id="standard"><a href="#standard" class="headerlink" title="standard"></a>standard</h4><p><img src="/2020/06/03/Android%E9%9D%A2%E8%AF%95-%E5%9F%BA%E7%A1%80/6.png"></p>
<p>图片有误，最上面的实例应该是新的</p>
<ol>
<li>系统默认使用该模式启动Activity</li>
<li>每次启动都会重新创建一个新的实例</li>
<li>调用它的onCreate()-onStart()-onResume()</li>
</ol>
<h4 id="singleTop"><a href="#singleTop" class="headerlink" title="singleTop"></a>singleTop</h4><p><img src="/2020/06/03/Android%E9%9D%A2%E8%AF%95-%E5%9F%BA%E7%A1%80/7.png"></p>
<p><img src="/2020/06/03/Android%E9%9D%A2%E8%AF%95-%E5%9F%BA%E7%A1%80/8.png"></p>
<ol>
<li>当前栈中已有该Activity实例并且位于栈顶时，onNewIntent()</li>
<li>当前栈中已有该Activity实例但不在栈顶，创建新的实例</li>
<li>当前栈中不存在该Activity实例，创建</li>
</ol>
<p>应用场景：</p>
<ul>
<li>IM对话框</li>
<li>新闻客户端推送</li>
</ul>
<h4 id="singleTask"><a href="#singleTask" class="headerlink" title="singleTask"></a>singleTask</h4><p><img src="/2020/06/03/Android%E9%9D%A2%E8%AF%95-%E5%9F%BA%E7%A1%80/9.png"></p>
<ol>
<li>首先根据taskAffinity（任务相关性，对默认及singleTop没有影响）去寻找当前是否存在一个对应名字的任务栈，一般情况为包名</li>
<li>如果不存在，则会创建新的Task栈，创建新的Activity实例</li>
<li>如果存在，则得到该任务栈，查找该任务栈中是否存在该Activity实例</li>
<li>存在则弹出其上方Activity实例并调用onNewIntent()，不存在则创建</li>
</ol>
<p>可以将不同APP的Activity设置相同的taskAffinity，这样两个不同APP的Activity会被放入同一个任务栈中</p>
<p>应用场景：应用的主界面</p>
<h4 id="singleInstance"><a href="#singleInstance" class="headerlink" title="singleInstance"></a>singleInstance</h4><p><img src="/2020/06/03/Android%E9%9D%A2%E8%AF%95-%E5%9F%BA%E7%A1%80/10.png"></p>
<p><img src="/2020/06/03/Android%E9%9D%A2%E8%AF%95-%E5%9F%BA%E7%A1%80/11.png"></p>
<ol>
<li>具有全局唯一性</li>
<li>如果在启动这样的Activity时，已存在了一个实例，会把他调度到前台复用</li>
<li>具有独占性（独自占有一个Task任务栈）</li>
</ol>
<p>应用场景：呼叫来电界面</p>
<h3 id="Service和线程的区别和应用场景"><a href="#Service和线程的区别和应用场景" class="headerlink" title="Service和线程的区别和应用场景"></a>Service和线程的区别和应用场景</h3><p>Thread程序执行的最小单元，分配CPU的基本单位</p>
<p>Service是Android的一种机制，是运行在主线程上的</p>
<h4 id="Thread生命周期"><a href="#Thread生命周期" class="headerlink" title="Thread生命周期"></a>Thread生命周期</h4><ol>
<li>新建</li>
<li>就绪</li>
<li>运行</li>
<li>死亡</li>
<li>阻塞</li>
</ol>
<p>缺点：无法控制</p>
<h4 id="Service生命周期"><a href="#Service生命周期" class="headerlink" title="Service生命周期"></a>Service生命周期</h4><ol>
<li>onCreate</li>
<li>onStart</li>
<li>onDestroy</li>
<li>onBind</li>
<li>onUnbind</li>
</ol>
<h3 id="如何管理Service生命周期"><a href="#如何管理Service生命周期" class="headerlink" title="如何管理Service生命周期"></a>如何管理Service生命周期</h3><p><img src="/2020/06/03/Android%E9%9D%A2%E8%AF%95-%E5%9F%BA%E7%A1%80/12.png"></p>
<ul>
<li>startService，多次启动onCreate()只会调用一次，onStartCommand()调用的次数与startService保持一致</li>
<li>stopService,一个Service被启动且被绑定，在没有解绑的情况下，stopService无法停止服务</li>
<li>bindService，可以绑定已经使用startService启动的服务</li>
</ul>
<h3 id="IntentService和Service的异同"><a href="#IntentService和Service的异同" class="headerlink" title="IntentService和Service的异同"></a>IntentService和Service的异同</h3><p>不建议在Service中编写耗时的逻辑和操作，否则会引起ANR</p>
<h4 id="IntentService"><a href="#IntentService" class="headerlink" title="IntentService"></a>IntentService</h4><ol>
<li>IntentService内部有一个工作线程handlerThread来处理耗时操作</li>
<li>IntentService是继承并处理异步请求的类</li>
<li>内有一个工作线程来处理耗时操作</li>
<li>IntentService内部	则是通过消息的方式发送给HandlerThread的，然后由Handler中的Looper来处理消息</li>
</ol>
<p>源码：</p>
<p>onCreate()方法</p>
<p><img src="/2020/06/03/Android%E9%9D%A2%E8%AF%95-%E5%9F%BA%E7%A1%80/13.png"></p>
<p>ServiceHandler继承Handler，传入的对象为Looper，Looper与HandlerThread绑定，ServiceHandler就持有了HandlerThread的Looper，便可执行异步任务</p>
<p>onStart()方法（onStartCommand-onStart）</p>
<p><img src="/2020/06/03/Android%E9%9D%A2%E8%AF%95-%E5%9F%BA%E7%A1%80/14.png"></p>
<p>ServiceHandler发送消息，这个消息最终交给HandlerThread去处理，本质是Looper从消息队列取出消息然后调用ServiceHandler进行处理</p>
<p>ServiceHandler</p>
<p><img src="/2020/06/03/Android%E9%9D%A2%E8%AF%95-%E5%9F%BA%E7%A1%80/15.png"></p>
<p><img src="/2020/06/03/Android%E9%9D%A2%E8%AF%95-%E5%9F%BA%E7%A1%80/16.png"></p>
<p>任务全部完成销毁</p>
<h3 id="启动和绑定Service服务先后次序问题"><a href="#启动和绑定Service服务先后次序问题" class="headerlink" title="启动和绑定Service服务先后次序问题"></a>启动和绑定Service服务先后次序问题</h3><p>服务的状态有启动状态和绑定状态，实际情况中一个服务可能有多种状态，但Android只会为一个服务创建一个实例对象，具体分为如下两种情况：</p>
<ol>
<li>先绑定服务后启动服务</li>
<li>先启动服务后绑定服务</li>
</ol>
<p>第一种，如果当前Service实例先以绑定状态运行了再以运行状态运行，绑定服务将会转为启动服务运行状态，这时候如果之前绑定服务的Activity销毁了也不会影响服务运行，只有调用停止服务的指令才会销毁服务</p>
<p>第二种，即使Activity解除绑定了，服务依然按启动服务的生命周期在后台运行，直到调用stopService()服务才会被销毁</p>
<h4 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h4><ol>
<li>启动服务优先级比绑定服务要高</li>
<li>服务在其托管进程的主线程运行（UI线程）</li>
</ol>
<h3 id="序列化：Parcelable和Serializable差异"><a href="#序列化：Parcelable和Serializable差异" class="headerlink" title="序列化：Parcelable和Serializable差异"></a>序列化：Parcelable和Serializable差异</h3><ul>
<li>序列化：内存中对象-&gt;磁盘（或其他介质）</li>
<li>反序列化：磁盘中对象-&gt;内存</li>
</ul>
<h4 id="Serializable"><a href="#Serializable" class="headerlink" title="Serializable"></a>Serializable</h4><p><img src="/2020/06/03/Android%E9%9D%A2%E8%AF%95-%E5%9F%BA%E7%A1%80/17.png"></p>
<p>serialVersionUID的作用，序列化操作的时候系统会把当前类的UID写到序列化的文件中，当反序列化的时候系统会检测文件中的UID，判断是否一致，一致说明序列化的版本和当前类的版本是一样的，就可以反序列化。Serializable在内存开销上比较大</p>
<h4 id="Parcelable"><a href="#Parcelable" class="headerlink" title="Parcelable"></a>Parcelable</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line">public class ParcableImplement implements Parcelable &#123;</span><br><span class="line"></span><br><span class="line">   	public int id;</span><br><span class="line">   	public String name;</span><br><span class="line"></span><br><span class="line">   	public ParcableImplement() &#123;</span><br><span class="line">   	&#125;</span><br><span class="line"></span><br><span class="line">   	protected ParcableImplement(Parcel in) &#123;</span><br><span class="line">       	this.id = in.readInt();</span><br><span class="line">       	this.name = in.readString();</span><br><span class="line">   	&#125;</span><br><span class="line"></span><br><span class="line">   	//当前对象的内容描述,一般返回0即可</span><br><span class="line">   	@Override</span><br><span class="line">   	public int describeContents() &#123;</span><br><span class="line">       	return 0;</span><br><span class="line">   	&#125;</span><br><span class="line"></span><br><span class="line">   	//将当前对象写入序列化结构中</span><br><span class="line">   	@Override</span><br><span class="line">   	public void writeToParcel(Parcel dest, int flags) &#123;</span><br><span class="line">       	dest.writeInt(this.id);</span><br><span class="line">       	dest.writeString(this.name);</span><br><span class="line">   	&#125;</span><br><span class="line"></span><br><span class="line">   	/**</span><br><span class="line">    	* public static final一个都不能少，内部对象CREATOR的名称也不能改变，必须全部大写。</span><br><span class="line">    	* 重写接口中的两个方法：</span><br><span class="line">    	* createFromParcel(Parcel in) 实现从Parcel容器中读取传递数据值,封装成Parcelable对象返回逻辑层，</span><br><span class="line">    	* newArray(int size) 创建一个类型为T，长度为size的数组，供外部类反序列化本类数组使用。</span><br><span class="line">    	*/</span><br><span class="line">   	public static final Creator&lt;ParcableImplement&gt; CREATOR = new Creator&lt;ParcableImplement&gt;() &#123;</span><br><span class="line">       </span><br><span class="line">       	//从序列化后的对象中创建原始对象</span><br><span class="line">       	@Override</span><br><span class="line">       	public ParcableImplement createFromParcel(Parcel source) &#123;</span><br><span class="line">           	return new ParcableImplement(source);</span><br><span class="line">       	&#125;</span><br><span class="line"></span><br><span class="line">       	//创建指定长度的原始对象数组</span><br><span class="line">       	@Override</span><br><span class="line">       	public ParcableImplement[] newArray(int size) &#123;</span><br><span class="line">           	return new ParcableImplement[size];</span><br><span class="line">       	&#125;</span><br><span class="line">   	&#125;;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="总结-1"><a href="#总结-1" class="headerlink" title="总结"></a>总结</h4><ul>
<li>两者的实现差异</li>
<li>两者效率上的对比，Parcelable内存开销更小。内存中传递数据，如Activity之间传递数据，AIDL之间传递数据更推荐Parcelable。对象序列化到存储设备中一般推荐使用Serializable，也可以防止Android不同版本之间的差异</li>
</ul>
<h3 id="binder应用：AIDL如何创建"><a href="#binder应用：AIDL如何创建" class="headerlink" title="binder应用：AIDL如何创建"></a>binder应用：AIDL如何创建</h3><p>AIDL是Android接口定义语言，是进程间通信(IPC)机制，Android中一个进程通常无法访问另一个进程的内存，这时可以使用AIDL来定义客户端服务端进程通信机制，是两者都认可的一种接口</p>
<h4 id="实现步骤"><a href="#实现步骤" class="headerlink" title="实现步骤"></a>实现步骤</h4><ol>
<li>创建AIDL：实体对象、新建AIDL文件、make工程</li>
<li>服务端：新建Service、创建Binder对象、定义方法</li>
<li>客户端：实现ServiceConnection、BindService</li>
</ol>
<p>Person</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line">public class Person implements Parcelable &#123;</span><br><span class="line"></span><br><span class="line">   	private String mName;</span><br><span class="line"></span><br><span class="line">   	public Person(String name) &#123;</span><br><span class="line">       	mName = name;</span><br><span class="line">   	&#125;</span><br><span class="line"></span><br><span class="line">   	protected Person(Parcel in) &#123;</span><br><span class="line">       	this.mName = in.readString();</span><br><span class="line">   	&#125;</span><br><span class="line"></span><br><span class="line">   	@Override</span><br><span class="line">   	public int describeContents() &#123;</span><br><span class="line">       	return 0;</span><br><span class="line">   	&#125;</span><br><span class="line"></span><br><span class="line">   	@Override</span><br><span class="line">   	public void writeToParcel(Parcel dest, int flags) &#123;</span><br><span class="line">       	dest.writeString(this.mName);</span><br><span class="line">   	&#125;</span><br><span class="line"></span><br><span class="line">   	public static final Creator&lt;Person&gt; CREATOR = new Creator&lt;Person&gt;() &#123;</span><br><span class="line">       	@Override</span><br><span class="line">       	public Person createFromParcel(Parcel source) &#123;</span><br><span class="line">           	return new Person(source);</span><br><span class="line">       	&#125;</span><br><span class="line"></span><br><span class="line">       	@Override</span><br><span class="line">       	public Person[] newArray(int size) &#123;</span><br><span class="line">           	return new Person[size];</span><br><span class="line">       	&#125;</span><br><span class="line">   	&#125;;</span><br><span class="line"></span><br><span class="line">   	@Override</span><br><span class="line">   	public String toString() &#123;</span><br><span class="line">       	return &quot;Person&#123;&quot; +</span><br><span class="line">               	&quot;mName=&#x27;&quot; + mName + &#x27;\&#x27;&#x27; +</span><br><span class="line">               	&#x27;&#125;&#x27;;</span><br><span class="line">   	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>Person.aidl</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">	package com.yly.interviewbat.aidlxuexi;</span><br><span class="line"></span><br><span class="line">	// Declare any non-default types here with import statements</span><br><span class="line"></span><br><span class="line">	parcelable Person;</span><br><span class="line">	</span><br><span class="line">IMyAidlInterface.aidl</span><br><span class="line"></span><br><span class="line">	package com.yly.interviewbat;</span><br><span class="line"></span><br><span class="line">	//可以理解为Person.aidl文件，通过它来映射对应的实体类</span><br><span class="line">	import com.yly.interviewbat.aidlxuexi.Person;</span><br><span class="line"></span><br><span class="line">	// Declare any non-default types here with import statements</span><br><span class="line"></span><br><span class="line">	interface IMyAidlInterface &#123;</span><br><span class="line">    	void addPerson(in Person person);</span><br><span class="line"></span><br><span class="line">    	List&lt;Person&gt; getPersonList();</span><br><span class="line">	&#125;</span><br></pre></td></tr></table></figure>

<p>MyAidlService服务端</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line">public class MyAidlService extends Service &#123;</span><br><span class="line"></span><br><span class="line">   	private final String TAG = this.getClass().getSimpleName();</span><br><span class="line"></span><br><span class="line">   	private ArrayList&lt;Person&gt; mPersons;</span><br><span class="line"></span><br><span class="line">   	/**</span><br><span class="line">    	* 创建生成的本地 Binder 对象，实现 AIDL 制定的方法</span><br><span class="line">    	*/</span><br><span class="line">   	private IBinder mIBinder = new IMyAidlInterface.Stub() &#123;</span><br><span class="line"></span><br><span class="line">       	@Override</span><br><span class="line">       	public void addPerson(Person person) throws RemoteException &#123;</span><br><span class="line">           	mPersons.add(person);</span><br><span class="line">       	&#125;</span><br><span class="line"></span><br><span class="line">       	@Override</span><br><span class="line">       	public List&lt;Person&gt; getPersonList() throws RemoteException &#123;</span><br><span class="line">           	return mPersons;</span><br><span class="line">       	&#125;</span><br><span class="line">   	&#125;;</span><br><span class="line"></span><br><span class="line">   	/**</span><br><span class="line">    	* 客户端与服务端绑定时的回调，返回 mIBinder 后客户端就可以通过它远程调用服务端的方法，即实现了通讯</span><br><span class="line">    	*</span><br><span class="line">    	* @param intent</span><br><span class="line">    	* @return</span><br><span class="line">    	*/</span><br><span class="line">   	@Nullable</span><br><span class="line">   	@Override</span><br><span class="line">   	public IBinder onBind(Intent intent) &#123;</span><br><span class="line">       	mPersons = new ArrayList&lt;&gt;();</span><br><span class="line">       	Log.d(TAG, &quot;MyAidlService onBind&quot;);</span><br><span class="line">       	return mIBinder;</span><br><span class="line">   	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>MyServiceActivity客户端</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line">public class MyServiceActivity extends Activity &#123;</span><br><span class="line"></span><br><span class="line">   	private Button mBtn;</span><br><span class="line"></span><br><span class="line">   	@Override</span><br><span class="line">   	protected void onCreate(@Nullable Bundle savedInstanceState) &#123;</span><br><span class="line">       	super.onCreate(savedInstanceState);</span><br><span class="line">       	setContentView(R.layout.activity_main);</span><br><span class="line">       	mBtn = findViewById(R.id.btn);</span><br><span class="line">       	mBtn.setOnClickListener(new View.OnClickListener() &#123;</span><br><span class="line">           	@Override</span><br><span class="line">           	public void onClick(View v) &#123;</span><br><span class="line">               	Intent intent1 = new Intent(getApplicationContext(), MyAidlService.class);</span><br><span class="line">               	bindService(intent1, mConnection, BIND_AUTO_CREATE);</span><br><span class="line">               	addPerson();</span><br><span class="line">           	&#125;</span><br><span class="line">       	&#125;);</span><br><span class="line"></span><br><span class="line">   	&#125;</span><br><span class="line"></span><br><span class="line">   	private IMyAidlInterface mAidl;</span><br><span class="line"></span><br><span class="line">   	private ServiceConnection mConnection = new ServiceConnection() &#123;</span><br><span class="line">       	@Override</span><br><span class="line">       	public void onServiceConnected(ComponentName name, IBinder service) &#123;</span><br><span class="line">           	//连接后拿到 Binder，转换成 AIDL，在不同进程会返回个代理</span><br><span class="line">           	mAidl = IMyAidlInterface.Stub.asInterface(service);</span><br><span class="line">       	&#125;</span><br><span class="line"></span><br><span class="line">       	@Override</span><br><span class="line">       	public void onServiceDisconnected(ComponentName name) &#123;</span><br><span class="line">           	mAidl = null;</span><br><span class="line">       	&#125;</span><br><span class="line">   	&#125;;</span><br><span class="line"></span><br><span class="line">   	List&lt;Person&gt; personList;</span><br><span class="line"></span><br><span class="line">   	public void addPerson() &#123;</span><br><span class="line">       	Random random = new Random();</span><br><span class="line">       	Person person = new Person(&quot;&quot; + random.nextInt(10));</span><br><span class="line"></span><br><span class="line">       	try &#123;</span><br><span class="line">           	mAidl.addPerson(person);</span><br><span class="line">           	personList = mAidl.getPersonList();</span><br><span class="line">       	&#125; catch (RemoteException e) &#123;</span><br><span class="line">           	e.printStackTrace();</span><br><span class="line">       	&#125;</span><br><span class="line">   	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="binder机制通信：AIDL生成java文件详细分析"><a href="#binder机制通信：AIDL生成java文件详细分析" class="headerlink" title="binder机制通信：AIDL生成java文件详细分析"></a>binder机制通信：AIDL生成java文件详细分析</h3><p>使用Binder机制，简化进程间通信开发的操作</p>
<p>aidl帮我们生成的Binder对象，同时生成跨平台接口转换类Stub以及在不同进程客户端拿到的代码Proxy</p>
<p>服务端和客户端是各有一个代理</p>
<h4 id="extends-android-os-IInterface"><a href="#extends-android-os-IInterface" class="headerlink" title="extends android.os.IInterface"></a>extends android.os.IInterface</h4><p>进程间通信接口，服务端实现接口，客户端调用接口，asBinder()方法返回当前接口所关联的Binder对象</p>
<h4 id="Stub-extends-android-os-Binder"><a href="#Stub-extends-android-os-Binder" class="headerlink" title="Stub extends android.os.Binder"></a>Stub extends android.os.Binder</h4><p>Binder类的包装类。</p>
<p>类中定义了DESCRIPTOR，是唯一的标识，一般为包名的完整路径。</p>
<p>attachInterface方法让当前接口与Binder绑定。</p>
<p>asInterface方法，将IBinder对象转换为接口类型（用于返回给客户端），如果不存在（不在一个进程）会创建一个代理（Proxy方法），如果本地存在，调用queryLocalInterface方法通过查询DESCRIPTOR标识查找。</p>
<p>onTransact方法，做所有代理操作的方法，根据code来查找，如TRANSACTION_addPerson</p>
<h4 id="代理类，Proxy-implements-com-yly-interviewbat-IMyAidlInterface"><a href="#代理类，Proxy-implements-com-yly-interviewbat-IMyAidlInterface" class="headerlink" title="代理类，Proxy implements com.yly.interviewbat.IMyAidlInterface"></a>代理类，Proxy implements com.yly.interviewbat.IMyAidlInterface</h4><p>不在同一个进程返回</p>
<p>asBinder方法，获取远端代理的Binder对象</p>
<p>mRemote.transact(Stub.TRANSACTION_addPerson, _data, _reply, 0)方法，利用远端的Binder对象从服务端获取数据</p>
<h3 id="广播：静态-动态注册使用、特点、应用场景"><a href="#广播：静态-动态注册使用、特点、应用场景" class="headerlink" title="广播：静态&amp;动态注册使用、特点、应用场景"></a>广播：静态&amp;动态注册使用、特点、应用场景</h3><p>动态注册代码</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">// 选择在Activity生命周期方法中的onResume()中注册</span><br><span class="line">   @Override</span><br><span class="line">   protected void onResume() &#123;</span><br><span class="line">       super.onResume();</span><br><span class="line"></span><br><span class="line">       // 1. 实例化BroadcastReceiver子类 &amp;  IntentFilter</span><br><span class="line">       mBroadcastReceiver = new MyBroadcastReceiver();</span><br><span class="line">       IntentFilter intentFilter = new IntentFilter();</span><br><span class="line"></span><br><span class="line">       // 2. 设置接收广播的类型</span><br><span class="line">       intentFilter.addAction(CONNECTIVITY_SERVICE);</span><br><span class="line"></span><br><span class="line">       // 3. 动态注册：调用Context的registerReceiver（）方法</span><br><span class="line">       registerReceiver(mBroadcastReceiver, intentFilter);</span><br><span class="line">   &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">   // 注册广播后，要在相应位置记得销毁广播</span><br><span class="line">   // 即在onPause() 中unregisterReceiver(mBroadcastReceiver)</span><br><span class="line">   // 当此Activity实例化时，会动态将MyBroadcastReceiver注册到系统中</span><br><span class="line">   // 当此Activity销毁时，动态注册的MyBroadcastReceiver将不再接收到相应的广播。</span><br><span class="line">   @Override</span><br><span class="line">   protected void onPause() &#123;</span><br><span class="line">       super.onPause();</span><br><span class="line">       //销毁在onResume()方法中的广播</span><br><span class="line">       unregisterReceiver(mBroadcastReceiver);</span><br><span class="line">   &#125;</span><br></pre></td></tr></table></figure>

<p>根据Activity生命周期，onPause()方法在Activity被销毁之前一定会被执行，而某些情况如内存不足销毁，onStop()及onDestroy()不一定会被执行，所以在onPause()方法注销广播，防止内存泄漏</p>
<ol>
<li>自动回调onReceive()方法</li>
<li>广播接收器运行在UI线程</li>
</ol>
<h4 id="使用方式"><a href="#使用方式" class="headerlink" title="使用方式"></a>使用方式</h4><ul>
<li>静态：在AndroidManifest.xml里通过<receiver>标签声明</receiver></li>
<li>动态：在代码里调用Context.registerReceiver</li>
</ul>
<h4 id="特点"><a href="#特点" class="headerlink" title="特点"></a>特点</h4><ul>
<li>静态：常驻进程中，不受组件生命周期影响</li>
<li>动态：跟随组件的生命周期变化</li>
</ul>
<h4 id="应用场景"><a href="#应用场景" class="headerlink" title="应用场景"></a>应用场景</h4><ul>
<li>静态：需要时刻监听广播</li>
<li>动态：需要在特定的时刻接受广播</li>
</ul>
<h3 id="webview安全漏洞"><a href="#webview安全漏洞" class="headerlink" title="webview安全漏洞"></a>webview安全漏洞</h3><h4 id="常见的坑"><a href="#常见的坑" class="headerlink" title="常见的坑"></a>常见的坑</h4><p>1.API16及以前版本存在远程代码执行安全漏洞，源于程序没有正确限制使用Webview.addJavascriptInterface方法，远程攻击者可以通过使用Java Reflection API利用该漏洞执行任意Java对象方法</p>
<p>2.webview在布局文件中的使用：在其他容器中时，先remove其中的webview，然后再调用webview的removeallviews和destroy方法，这样不会导致内存泄漏</p>
<p>3.jsbridge</p>
<p>4.webviewClient.onPageFinished–&gt;webChromeClient.onProgressChanged</p>
<p>5.后台耗电，webview会自己开启线程，没有很好的销毁webview</p>
<p>6.webview硬件加速导致页面渲染的问题，出现页面加载白块同时页面闪烁的情况</p>
<h4 id="内存泄漏"><a href="#内存泄漏" class="headerlink" title="内存泄漏"></a>内存泄漏</h4><p>webview会关联Activity，而webview执行的操作是在新的线程当中，Activity的生命周期跟这个线程的生命周期不一样，会导致一直持有Activity的引用</p>
<p>1.独立进程，简单暴力，可能涉及进程间通信</p>
<p>2.动态添加webview，对传入webview中使用的Context使用弱引用，动态添加即在布局创建一个ViewGroup用来放置Webview，Activity创建时add进来，停止时remove掉</p>

                    
                </div>

                

                <div class="post-bottom-tags-and-share border-box">
                    <div>
                        
                            <ul class="post-tags-box border-box">
                                
                                    <li class="tag-item border-box">
                                        <i class="icon fas fa-hashtag"></i>&nbsp;<a href="/tags/Android%E9%9D%A2%E8%AF%95/">Android面试</a>
                                    </li>
                                
                            </ul>
                        
                    </div>
                    <div>
                        
                    </div>
                </div>

                

                
                    <div class="post-nav border-box">
                        
                            <div class="prev-post">
                                <a class="prev"
                                   rel="prev"
                                   href="/2020/06/24/Android%E9%9D%A2%E8%AF%95-%E5%BC%82%E6%AD%A5%E6%B6%88%E6%81%AF/"
                                   title="Android面试-异步消息"
                                >
                                    <span class="left arrow-icon flex-center">
                                        <i class="fas fa-chevron-left"></i>
                                    </span>
                                    <span class="title flex-center">
                                        <span class="post-nav-title-item text-ellipsis">Android面试-异步消息</span>
                                        <span class="post-nav-item">上一篇</span>
                                    </span>
                                </a>
                            </div>
                        
                        
                            <div class="next-post">
                                <a class="next"
                                   rel="next"
                                   href="/2020/02/02/Java%E9%9D%A2%E8%AF%95-%E9%AB%98%E7%BA%A7%E7%9F%A5%E8%AF%86%E7%82%B9/"
                                   title="Java面试-高级知识点"
                                >
                                    <span class="title flex-center">
                                        <span class="post-nav-title-item text-ellipsis">Java面试-高级知识点</span>
                                        <span class="post-nav-item">下一篇</span>
                                    </span>
                                    <span class="right arrow-icon flex-center">
                                        <i class="fas fa-chevron-right"></i>
                                    </span>
                                </a>
                            </div>
                        
                    </div>
                

                
                    






                
            </div>
        </div>

        
            <div class="pc-post-toc right-toc">
                <div class="post-toc-wrap border-box">
    <div class="post-toc border-box">
        <ol class="nav"><li class="nav-item nav-level-3"><a class="nav-link" href="#Activity"><span class="nav-number">1.</span> <span class="nav-text">Activity</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Activity%E4%BB%BB%E5%8A%A1%E6%A0%88"><span class="nav-number">2.</span> <span class="nav-text">Activity任务栈</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Activity%E5%9B%9B%E7%A7%8D%E5%BD%A2%E6%80%81"><span class="nav-number">3.</span> <span class="nav-text">Activity四种形态</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%AD%A3%E5%B8%B8%E6%83%85%E5%86%B5%E7%94%9F%E5%91%BD%E5%91%A8%E6%9C%9F%E5%9B%9E%E8%B0%83"><span class="nav-number">4.</span> <span class="nav-text">正常情况生命周期回调</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%BC%82%E5%B8%B8%E6%83%85%E5%86%B5%E7%94%9F%E5%91%BD%E5%91%A8%E6%9C%9F%E5%9B%9E%E8%B0%83"><span class="nav-number">5.</span> <span class="nav-text">异常情况生命周期回调</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%94%9F%E5%91%BD%E5%91%A8%E6%9C%9F%E6%80%BB%E7%BB%93"><span class="nav-number">6.</span> <span class="nav-text">生命周期总结</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Activity%E4%B9%8B%E9%97%B4%E9%80%9A%E4%BF%A1"><span class="nav-number">7.</span> <span class="nav-text">Activity之间通信</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Activity%E4%B8%8EFragment%E9%80%9A%E4%BF%A1"><span class="nav-number">8.</span> <span class="nav-text">Activity与Fragment通信</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#Activity%E5%B0%86%E6%95%B0%E6%8D%AE%E4%BC%A0%E9%80%92%E7%BB%99Fragment"><span class="nav-number">8.1.</span> <span class="nav-text">Activity将数据传递给Fragment</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Fragment%E5%B0%86%E6%95%B0%E6%8D%AE%E4%BC%A0%E9%80%92%E7%BB%99Activity"><span class="nav-number">8.2.</span> <span class="nav-text">Fragment将数据传递给Activity</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Activity%E4%B8%8EService%E9%80%9A%E4%BF%A1"><span class="nav-number">9.</span> <span class="nav-text">Activity与Service通信</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Activity%E5%90%AF%E5%8A%A8%E6%A8%A1%E5%BC%8F"><span class="nav-number">10.</span> <span class="nav-text">Activity启动模式</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#standard"><span class="nav-number">10.1.</span> <span class="nav-text">standard</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#singleTop"><span class="nav-number">10.2.</span> <span class="nav-text">singleTop</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#singleTask"><span class="nav-number">10.3.</span> <span class="nav-text">singleTask</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#singleInstance"><span class="nav-number">10.4.</span> <span class="nav-text">singleInstance</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Service%E5%92%8C%E7%BA%BF%E7%A8%8B%E7%9A%84%E5%8C%BA%E5%88%AB%E5%92%8C%E5%BA%94%E7%94%A8%E5%9C%BA%E6%99%AF"><span class="nav-number">11.</span> <span class="nav-text">Service和线程的区别和应用场景</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#Thread%E7%94%9F%E5%91%BD%E5%91%A8%E6%9C%9F"><span class="nav-number">11.1.</span> <span class="nav-text">Thread生命周期</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Service%E7%94%9F%E5%91%BD%E5%91%A8%E6%9C%9F"><span class="nav-number">11.2.</span> <span class="nav-text">Service生命周期</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%A6%82%E4%BD%95%E7%AE%A1%E7%90%86Service%E7%94%9F%E5%91%BD%E5%91%A8%E6%9C%9F"><span class="nav-number">12.</span> <span class="nav-text">如何管理Service生命周期</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#IntentService%E5%92%8CService%E7%9A%84%E5%BC%82%E5%90%8C"><span class="nav-number">13.</span> <span class="nav-text">IntentService和Service的异同</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#IntentService"><span class="nav-number">13.1.</span> <span class="nav-text">IntentService</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%90%AF%E5%8A%A8%E5%92%8C%E7%BB%91%E5%AE%9AService%E6%9C%8D%E5%8A%A1%E5%85%88%E5%90%8E%E6%AC%A1%E5%BA%8F%E9%97%AE%E9%A2%98"><span class="nav-number">14.</span> <span class="nav-text">启动和绑定Service服务先后次序问题</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%80%BB%E7%BB%93"><span class="nav-number">14.1.</span> <span class="nav-text">总结</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%BA%8F%E5%88%97%E5%8C%96%EF%BC%9AParcelable%E5%92%8CSerializable%E5%B7%AE%E5%BC%82"><span class="nav-number">15.</span> <span class="nav-text">序列化：Parcelable和Serializable差异</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#Serializable"><span class="nav-number">15.1.</span> <span class="nav-text">Serializable</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Parcelable"><span class="nav-number">15.2.</span> <span class="nav-text">Parcelable</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%80%BB%E7%BB%93-1"><span class="nav-number">15.3.</span> <span class="nav-text">总结</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#binder%E5%BA%94%E7%94%A8%EF%BC%9AAIDL%E5%A6%82%E4%BD%95%E5%88%9B%E5%BB%BA"><span class="nav-number">16.</span> <span class="nav-text">binder应用：AIDL如何创建</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%AE%9E%E7%8E%B0%E6%AD%A5%E9%AA%A4"><span class="nav-number">16.1.</span> <span class="nav-text">实现步骤</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#binder%E6%9C%BA%E5%88%B6%E9%80%9A%E4%BF%A1%EF%BC%9AAIDL%E7%94%9F%E6%88%90java%E6%96%87%E4%BB%B6%E8%AF%A6%E7%BB%86%E5%88%86%E6%9E%90"><span class="nav-number">17.</span> <span class="nav-text">binder机制通信：AIDL生成java文件详细分析</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#extends-android-os-IInterface"><span class="nav-number">17.1.</span> <span class="nav-text">extends android.os.IInterface</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Stub-extends-android-os-Binder"><span class="nav-number">17.2.</span> <span class="nav-text">Stub extends android.os.Binder</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E4%BB%A3%E7%90%86%E7%B1%BB%EF%BC%8CProxy-implements-com-yly-interviewbat-IMyAidlInterface"><span class="nav-number">17.3.</span> <span class="nav-text">代理类，Proxy implements com.yly.interviewbat.IMyAidlInterface</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%B9%BF%E6%92%AD%EF%BC%9A%E9%9D%99%E6%80%81-%E5%8A%A8%E6%80%81%E6%B3%A8%E5%86%8C%E4%BD%BF%E7%94%A8%E3%80%81%E7%89%B9%E7%82%B9%E3%80%81%E5%BA%94%E7%94%A8%E5%9C%BA%E6%99%AF"><span class="nav-number">18.</span> <span class="nav-text">广播：静态&amp;动态注册使用、特点、应用场景</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E4%BD%BF%E7%94%A8%E6%96%B9%E5%BC%8F"><span class="nav-number">18.1.</span> <span class="nav-text">使用方式</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E7%89%B9%E7%82%B9"><span class="nav-number">18.2.</span> <span class="nav-text">特点</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%BA%94%E7%94%A8%E5%9C%BA%E6%99%AF"><span class="nav-number">18.3.</span> <span class="nav-text">应用场景</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#webview%E5%AE%89%E5%85%A8%E6%BC%8F%E6%B4%9E"><span class="nav-number">19.</span> <span class="nav-text">webview安全漏洞</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%B8%B8%E8%A7%81%E7%9A%84%E5%9D%91"><span class="nav-number">19.1.</span> <span class="nav-text">常见的坑</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%86%85%E5%AD%98%E6%B3%84%E6%BC%8F"><span class="nav-number">19.2.</span> <span class="nav-text">内存泄漏</span></a></li></ol></li></ol>
    </div>
</div>

            </div>
        
    </div>
</div>


                
            </div>
        </div>

        <div class="page-main-content-bottom border-box">
            
<footer class="footer border-box">
    <div class="copyright-info info-item">
        &copy;&nbsp;<span>2017</span>&nbsp;-&nbsp;2024
        
            &nbsp;<i class="fas fa-heart icon-animate"></i>&nbsp;&nbsp;<a href="/">Mayo</a>
        
    </div>

    <div class="theme-info info-item">
        由&nbsp;<a target="_blank" href="https://hexo.io">Hexo</a>&nbsp;驱动&nbsp;&&nbsp;主题&nbsp;<a class="keep-version" target="_blank" href="https://github.com/XPoet/hexo-theme-keep">Keep</a>
    </div>

    

    

    
</footer>

        </div>
    </div>

    <!-- post tools -->
    
        <div class="post-tools right-toc">
            $li-margin-bottom = 0.8rem
$post-tool-button-width = 2.5rem

.post-tools-container {
  padding-top var(--component-gap)

  .post-tools-list {
    li {
      margin-bottom $li-margin-bottom

      &:last-child {
        margin-bottom 0
      }
    }


    li.tools-item {
      position relative
      box-sizing border-box
      width $post-tool-button-width
      height $post-tool-button-width
      color var(--text-color-3)
      font-size 1.2rem
      background var(--background-color-1)
      border-radius 50%
      box-shadow 2px 2px 5px var(--shadow-color)
      cursor pointer

      &:hover {
        box-shadow 2px 2px 8px var(--shadow-hover-color)
      }

      i {
        color var(--text-color-3)
      }


      &:hover {
        color var(--background-color-1)
        background var(--primary-color)

        i {
          color var(--background-color-1) !important
        }
      }


      &.toggle-show-toc {
        display none
      }


      &.go-to-comments {
        .post-comments-count {
          position absolute
          top 0
          right -1rem
          display none
          align-items center
          justify-content center
          box-sizing border-box
          min-width 1.1rem
          height 1.1rem
          padding 0 0.2rem
          color var(--badge-color)
          font-size 12px
          background var(--badge-background-color)
          border-radius 0.4rem

          +keep-tablet() {
            display none !important
          }
        }
      }
    }


    li.status-item {
      width $post-tool-button-width
      height $post-tool-button-width
      color var(--text-color-3)
      font-size 1.6rem
      cursor pointer


      &.post-lock {
        cursor default

        .fa-lock-open {
          display none
          color var(--keep-success-color)
        }

        &.decrypt {
          cursor pointer

          .fa-lock-open {
            display block
          }

          .fa-lock {
            display none
          }
        }
      }
    }
  }
}

        </div>
    

    <!-- side tools -->
    <div class="side-tools">
        <div class="side-tools-container border-box ">
    <ul class="side-tools-list side-tools-show-handle border-box">
        <li class="tools-item tool-font-adjust-plus flex-center">
            <i class="fas fa-search-plus"></i>
        </li>

        <li class="tools-item tool-font-adjust-minus flex-center">
            <i class="fas fa-search-minus"></i>
        </li>

        <li class="tools-item tool-toggle-theme-mode flex-center">
            <i class="fas fa-moon"></i>
        </li>

        <!-- rss -->
        

        <li class="tools-item tool-scroll-to-bottom flex-center">
            <i class="fas fa-arrow-down"></i>
        </li>
    </ul>

    <ul class="exposed-tools-list border-box">
        
            <li class="tools-item toggle-show-toc-tablet flex-center">
                <i class="fas fa-list"></i>
            </li>
        

        

        <li class="tools-item tool-toggle-show flex-center">
            <i class="fas fa-cog fa-spin"></i>
        </li>

        <li class="tools-item tool-scroll-to-top flex-center show-arrow">
            <i class="arrow fas fa-arrow-up"></i>
            <span class="percent"></span>
        </li>
    </ul>
</div>

    </div>

    <!-- image mask -->
    <div class="zoom-in-image-mask">
    <img class="zoom-in-image">
</div>


    <!-- local search -->
    

    <!-- tablet toc -->
    
        <div class="tablet-post-toc-mask">
            <div class="tablet-post-toc">
                <div class="post-toc-wrap border-box">
    <div class="post-toc border-box">
        <ol class="nav"><li class="nav-item nav-level-3"><a class="nav-link" href="#Activity"><span class="nav-number">1.</span> <span class="nav-text">Activity</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Activity%E4%BB%BB%E5%8A%A1%E6%A0%88"><span class="nav-number">2.</span> <span class="nav-text">Activity任务栈</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Activity%E5%9B%9B%E7%A7%8D%E5%BD%A2%E6%80%81"><span class="nav-number">3.</span> <span class="nav-text">Activity四种形态</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%AD%A3%E5%B8%B8%E6%83%85%E5%86%B5%E7%94%9F%E5%91%BD%E5%91%A8%E6%9C%9F%E5%9B%9E%E8%B0%83"><span class="nav-number">4.</span> <span class="nav-text">正常情况生命周期回调</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%BC%82%E5%B8%B8%E6%83%85%E5%86%B5%E7%94%9F%E5%91%BD%E5%91%A8%E6%9C%9F%E5%9B%9E%E8%B0%83"><span class="nav-number">5.</span> <span class="nav-text">异常情况生命周期回调</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%94%9F%E5%91%BD%E5%91%A8%E6%9C%9F%E6%80%BB%E7%BB%93"><span class="nav-number">6.</span> <span class="nav-text">生命周期总结</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Activity%E4%B9%8B%E9%97%B4%E9%80%9A%E4%BF%A1"><span class="nav-number">7.</span> <span class="nav-text">Activity之间通信</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Activity%E4%B8%8EFragment%E9%80%9A%E4%BF%A1"><span class="nav-number">8.</span> <span class="nav-text">Activity与Fragment通信</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#Activity%E5%B0%86%E6%95%B0%E6%8D%AE%E4%BC%A0%E9%80%92%E7%BB%99Fragment"><span class="nav-number">8.1.</span> <span class="nav-text">Activity将数据传递给Fragment</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Fragment%E5%B0%86%E6%95%B0%E6%8D%AE%E4%BC%A0%E9%80%92%E7%BB%99Activity"><span class="nav-number">8.2.</span> <span class="nav-text">Fragment将数据传递给Activity</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Activity%E4%B8%8EService%E9%80%9A%E4%BF%A1"><span class="nav-number">9.</span> <span class="nav-text">Activity与Service通信</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Activity%E5%90%AF%E5%8A%A8%E6%A8%A1%E5%BC%8F"><span class="nav-number">10.</span> <span class="nav-text">Activity启动模式</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#standard"><span class="nav-number">10.1.</span> <span class="nav-text">standard</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#singleTop"><span class="nav-number">10.2.</span> <span class="nav-text">singleTop</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#singleTask"><span class="nav-number">10.3.</span> <span class="nav-text">singleTask</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#singleInstance"><span class="nav-number">10.4.</span> <span class="nav-text">singleInstance</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Service%E5%92%8C%E7%BA%BF%E7%A8%8B%E7%9A%84%E5%8C%BA%E5%88%AB%E5%92%8C%E5%BA%94%E7%94%A8%E5%9C%BA%E6%99%AF"><span class="nav-number">11.</span> <span class="nav-text">Service和线程的区别和应用场景</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#Thread%E7%94%9F%E5%91%BD%E5%91%A8%E6%9C%9F"><span class="nav-number">11.1.</span> <span class="nav-text">Thread生命周期</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Service%E7%94%9F%E5%91%BD%E5%91%A8%E6%9C%9F"><span class="nav-number">11.2.</span> <span class="nav-text">Service生命周期</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%A6%82%E4%BD%95%E7%AE%A1%E7%90%86Service%E7%94%9F%E5%91%BD%E5%91%A8%E6%9C%9F"><span class="nav-number">12.</span> <span class="nav-text">如何管理Service生命周期</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#IntentService%E5%92%8CService%E7%9A%84%E5%BC%82%E5%90%8C"><span class="nav-number">13.</span> <span class="nav-text">IntentService和Service的异同</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#IntentService"><span class="nav-number">13.1.</span> <span class="nav-text">IntentService</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%90%AF%E5%8A%A8%E5%92%8C%E7%BB%91%E5%AE%9AService%E6%9C%8D%E5%8A%A1%E5%85%88%E5%90%8E%E6%AC%A1%E5%BA%8F%E9%97%AE%E9%A2%98"><span class="nav-number">14.</span> <span class="nav-text">启动和绑定Service服务先后次序问题</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%80%BB%E7%BB%93"><span class="nav-number">14.1.</span> <span class="nav-text">总结</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%BA%8F%E5%88%97%E5%8C%96%EF%BC%9AParcelable%E5%92%8CSerializable%E5%B7%AE%E5%BC%82"><span class="nav-number">15.</span> <span class="nav-text">序列化：Parcelable和Serializable差异</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#Serializable"><span class="nav-number">15.1.</span> <span class="nav-text">Serializable</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Parcelable"><span class="nav-number">15.2.</span> <span class="nav-text">Parcelable</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%80%BB%E7%BB%93-1"><span class="nav-number">15.3.</span> <span class="nav-text">总结</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#binder%E5%BA%94%E7%94%A8%EF%BC%9AAIDL%E5%A6%82%E4%BD%95%E5%88%9B%E5%BB%BA"><span class="nav-number">16.</span> <span class="nav-text">binder应用：AIDL如何创建</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%AE%9E%E7%8E%B0%E6%AD%A5%E9%AA%A4"><span class="nav-number">16.1.</span> <span class="nav-text">实现步骤</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#binder%E6%9C%BA%E5%88%B6%E9%80%9A%E4%BF%A1%EF%BC%9AAIDL%E7%94%9F%E6%88%90java%E6%96%87%E4%BB%B6%E8%AF%A6%E7%BB%86%E5%88%86%E6%9E%90"><span class="nav-number">17.</span> <span class="nav-text">binder机制通信：AIDL生成java文件详细分析</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#extends-android-os-IInterface"><span class="nav-number">17.1.</span> <span class="nav-text">extends android.os.IInterface</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Stub-extends-android-os-Binder"><span class="nav-number">17.2.</span> <span class="nav-text">Stub extends android.os.Binder</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E4%BB%A3%E7%90%86%E7%B1%BB%EF%BC%8CProxy-implements-com-yly-interviewbat-IMyAidlInterface"><span class="nav-number">17.3.</span> <span class="nav-text">代理类，Proxy implements com.yly.interviewbat.IMyAidlInterface</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%B9%BF%E6%92%AD%EF%BC%9A%E9%9D%99%E6%80%81-%E5%8A%A8%E6%80%81%E6%B3%A8%E5%86%8C%E4%BD%BF%E7%94%A8%E3%80%81%E7%89%B9%E7%82%B9%E3%80%81%E5%BA%94%E7%94%A8%E5%9C%BA%E6%99%AF"><span class="nav-number">18.</span> <span class="nav-text">广播：静态&amp;动态注册使用、特点、应用场景</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E4%BD%BF%E7%94%A8%E6%96%B9%E5%BC%8F"><span class="nav-number">18.1.</span> <span class="nav-text">使用方式</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E7%89%B9%E7%82%B9"><span class="nav-number">18.2.</span> <span class="nav-text">特点</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%BA%94%E7%94%A8%E5%9C%BA%E6%99%AF"><span class="nav-number">18.3.</span> <span class="nav-text">应用场景</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#webview%E5%AE%89%E5%85%A8%E6%BC%8F%E6%B4%9E"><span class="nav-number">19.</span> <span class="nav-text">webview安全漏洞</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%B8%B8%E8%A7%81%E7%9A%84%E5%9D%91"><span class="nav-number">19.1.</span> <span class="nav-text">常见的坑</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%86%85%E5%AD%98%E6%B3%84%E6%BC%8F"><span class="nav-number">19.2.</span> <span class="nav-text">内存泄漏</span></a></li></ol></li></ol>
    </div>
</div>

            </div>
        </div>
    
</main>



<!-- common -->

<script src="/js/utils.js"></script>

<script src="/js/header-shrink.js"></script>

<script src="/js/back2top.js"></script>

<script src="/js/toggle-theme.js"></script>

<script src="/js/code-block.js"></script>

<script src="/js/main.js"></script>

<script src="/js/libs/anime.min.js"></script>


<!-- local-search -->


<!-- lazyload -->


<div class="">
    <!-- home page -->
    

    <!-- post page -->
    
        <!-- post-helper -->
        
<script src="/js/post/post-helper.js"></script>


        <!-- toc -->
        
            
<script src="/js/post/toc.js"></script>

        

        <!-- copyright-info -->
        

        <!-- share -->
        
    

    <!-- categories page -->
    

    <!-- links page -->
    

    <!-- photos page -->
    

    <!-- tools page -->
    
</div>

<!-- mermaid -->


<!-- pjax -->



</body>
</html>
